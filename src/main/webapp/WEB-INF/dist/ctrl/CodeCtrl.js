angular.module("myApp").controller("CodeCtrl",["$rootScope","$scope","$location","$routeParams","$http","$window",function(e,o,i,t,n,a){function d(e,o){return-1!==e.indexOf(o,e.length-o.length)}var l=a.innerHeight-115;o.aceheight={height:l+"px"},o.aceEditorOptions={mode:"scheme",onLoad:function(e){e.$blockScrolling=1/0,e.setReadOnly(!0)}},o.nodePath=[],o.promise=n.post(ctx+"/basic/CodePreviewCtrl/navigator",{id:t.id}).success(function(e){o.projectName=e.data.fileName,o.showNode=e.data.children[0],o.nodePath.push(o.showNode),o.navView="fileList"}),o.navTreeClick=function(e,i){e.leaf?(o.viewFile=!0,o.navView="fileContent",o.showFile(e)):(o.viewFile=!1,o.navView="fileList",o.showNode=e),o.nodePath.push(e)},o.navTreeParent=function(){o.viewFile=!1,o.navView="fileList",o.showNode=o.nodePath.pop()},o.navTreeParentNode=function(e,i){o.showNode=e,o.viewFile=!1,o.navView="fileList",o.nodePath=o.nodePath.slice(0,i+1)},o.tabs=[],o.selectedIndex=0,selected=null,previous=null,o.showFile=function(e){if(e.leaf){var i={path:e.filePath,tplPath:e.tplPath,type:e.type,nodeId:e.nodeId,projectId:t.id};o.promise=n.post(ctx+"/basic/CodePreviewCtrl/getFileContent",i).success(function(i){o.aceEditorOptions.mode="scheme",d(e.fileName,".js")?o.aceEditorOptions.mode="javascript":d(e.fileName,".xml")?o.aceEditorOptions.mode="xml":d(e.fileName,".java")?o.aceEditorOptions.mode="java":d(e.fileName,".sql")?o.aceEditorOptions.mode="sql":d(e.fileName,".html")?o.aceEditorOptions.mode="html":d(e.fileName,".jsp")&&(o.aceEditorOptions.mode="jsp"),o.vieFileContent=i.data})}},o.openProject=function(){i.path("/project").search({id:t.id})},o.previewProject=function(){window.open(ctx+"/preview?id="+t.id)},o.downloadProject=function(){window.open(ctx+"/dowload?id="+t.id)}}]);