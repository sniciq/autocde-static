angular.module("myApp").controller("ProjectAdminCtrl",["$scope","$http","$location","$mdDialog","$anchorScroll",function(e,t,o,c,i){e.pagination={start:0,limit:10,sort:"id",dir:"desc",maxSize:8,currentPage:1,limitOptions:[10,20,50,100]},e.searchForm={extLimit:e.pagination},e.isLoading=!1,e.selectedItems={},e.search=function(){e.isLoading=!0,i("content"),t.post(ctx+"/admin/ProjectAdminCtrl/search",e.searchForm).success(function(t){e.dataList=t,e.isLoading=!1})},e.pageChanged=function(){e.pagination.start=(e.pagination.currentPage-1)*e.pagination.limit,e.search()},e.clearSearch=function(){e.searchForm={extLimit:e.pagination},e.search()},e.openProject=function(){var t=Object.keys(e.selectedItems)[0],c=e.selectedItems[t];o.path("/project").search({id:c.idCode})},e.editProject=function(){var t=Object.keys(e.selectedItems)[0],c=e.selectedItems[t];o.path("/project_edit").search({id:c.idCode})},e.previewProjectCode=function(){var t=Object.keys(e.selectedItems)[0],c=e.selectedItems[t];o.path("/project_code").search({id:c.idCode})},e.previewProject=function(){var t=Object.keys(e.selectedItems)[0],o=e.selectedItems[t];window.open(ctx+"/preview?id="+o.idCode)},e.downloadProject=function(){var t=Object.keys(e.selectedItems)[0],o=e.selectedItems[t];window.open(ctx+"/dowload?id="+o.idCode)},e.deleteProject=function(o){if(1!=Object.keys(e.selectedItems).length)return void e.$root.$broadcast("notify",{type:"error",title:"错误",info:"请选中一个项目后再执行该操作！",timeOut:2e3});var i=Object.keys(e.selectedItems)[0],o=e.selectedItems[i],s=c.confirm().title("确认").textContent("确认删除项目: "+o.name+" ?").ariaLabel("确认").ok("确认").cancel("取消");c.show(s).then(function(){e.promise=t.post(ctx+"/basic/project/delete",{id:o.idCode}).success(function(t){"success"==t.result?(e.selectedItems={},e.$root.$broadcast("notify",{type:"success",title:"提示",info:"删除成功",timeOut:2e3}),e.search()):e.$root.$broadcast("notify",{type:"error",title:"错误",info:t.info,timeOut:2e3})})})},e.search()}]);