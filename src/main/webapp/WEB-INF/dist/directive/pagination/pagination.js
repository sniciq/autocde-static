angular.module("ac.util.Pagination",[]).controller("PaginationController",["$scope","$mdMedia","$attrs","$parse",function(e,t,a,n){var i=this,r={$setViewValue:angular.noop},s=a.numPages?n(a.numPages).assign:angular.noop;this.init=function(t,o){r=t,this.config=o,r.$render=function(){i.render()},a.itemsPerPage?e.$parent.$watch(n(a.itemsPerPage),function(t){i.itemsPerPage=parseInt(t,10),e.totalPages=i.calculateTotalPages()}):this.itemsPerPage=o.itemsPerPage,e.$watch("totalItems",function(){e.totalPages=i.calculateTotalPages()}),e.$watch("totalPages",function(t){s(e.$parent,t),e.page>t?e.selectPage(t):r.$render()})},this.calculateTotalPages=function(){var t=this.itemsPerPage<1?1:Math.ceil(e.totalItems/this.itemsPerPage);return Math.max(t||0,1)},this.render=function(){e.page=parseInt(r.$viewValue,10)||1},e.selectPage=function(t,a){e.page!==t&&t>0&&t<=e.totalPages&&(a&&a.target&&a.target.blur(),r.$setViewValue(t),r.$render())},e.getText=function(t){return e[t+"Text"]||i.config[t+"Text"]},e.noPrevious=function(){return 1===e.page},e.noNext=function(){return e.page===e.totalPages}}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"第一页",previousText:"上一页",nextText:"下一页",lastText:"最后一页",rotate:!0}).directive("pagination",["$parse","$mdMedia","paginationConfig",function(e,t,a){return{restrict:"EA",scope:{totalItems:"=",itemsPerPage:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",replace:!0,template:'			<div layout="row" layout-align="end center" layout-padding>				<div hide show-gt-xs>显示：{{itemsPerPage}} 条，共 {{totalItems}} 条, 页码: {{page}} / {{totalPages}}</div>				<div hide show-xs>共{{totalItems}}条, 页码:{{page}}/{{totalPages}}</div>				<md-button ng-disabled="page<=1" class="md-primary" style="min-width: 30px;margin: 3px 3px;" ng-click="selectPage(page - 1, $event)">上一页</md-button>				<md-button hide show-gt-sm class="md-primary" ng-repeat="page in pages track by $index" ng-class="{\'md-raised\': page.active}" ng-click="selectPage(page.number, $event)" style="cursor: pointer;min-width: 30px;margin: 3px 3px;">{{page.text}}</md-button>				<md-button ng-disabled="page>=totalPages" class="md-primary" style="min-width: 30px;margin: 3px 3px;" ng-click="selectPage(page + 1, $event)">下一页</md-button>			</div>		',link:function(t,n,i,r){function s(e,t,a){return{number:e,text:t,active:a}}function o(e,t){var a=[],n=1,i=t,r=angular.isDefined(c)&&t>c;r&&(u?(n=Math.max(e-Math.floor(c/2),1),i=n+c-1,i>t&&(i=t,n=i-c+1)):(n=(Math.ceil(e/c)-1)*c+1,i=Math.min(n+c-1,t)));for(var o=n;i>=o;o++){var g=s(o,o,o===e);a.push(g)}if(r&&!u){if(n>1){var l=s(n-1,"...",!1);a.unshift(l)}if(t>i){var p=s(i+1,"...",!1);a.push(p)}}return a}var g=r[0],l=r[1];if(l){var c=angular.isDefined(i.maxSize)?t.$parent.$eval(i.maxSize):a.maxSize,u=angular.isDefined(i.rotate)?t.$parent.$eval(i.rotate):a.rotate;g.init(l,a),i.maxSize&&t.$parent.$watch(e(i.maxSize),function(e){c=parseInt(e,10),g.render()});var p=g.render;g.render=function(){p(),t.page>0&&t.page<=t.totalPages&&(t.pages=o(t.page,t.totalPages))}}}}}]);